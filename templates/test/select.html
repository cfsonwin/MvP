<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
     <link rel="stylesheet" href="{% static 'leaflet/leaflet.css'%}"/>
 <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="{% static 'leaflet/leaflet.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'bootstrap.min.css'%}">
    <script src="{% static 'bootstrap.min.js'%}"></script>
    <style>
        .container_border {
          background-color: #fff;
          min-height: 500px;
          min-width: 500px;
          margin: auto;
          padding: 20px;
          border-style: outset;
        }

        .center {
          position: absolute;
          top: 50%;
          width: 100%;
          text-align: center;
          font-size: 18px;
        }

    </style>
</head>
<body>
    <a href="{% url 'mT_index' %}" >Back test Homepage</a>
    <div class="container mt-3">
        <form role="form" class="form-horizontal needs-validation" action="{% url 'mT_get_select_info' %}" method="POST" enctype="multipart/form-data" novalidate>
            {% csrf_token%}
            <div>
                <label for="select_method">Select one method to input location information</label>
                <select class="custom-select" onChange="javascript:test(this.value)" id="select_method" name="select_method" required>
                    <option id="op2" selected value="SelectFromMap">Select the location from the map </option>
                    <option id="op1"  value="AddManually">Add the Location manually</option>
                </select>
                <div class="invalid-feedback">
                    Please select a valid state.
                </div>
            </div>

            <div class="container_border mt-3" id="AddManually" style="display:none">
                <div class="form-group">
                    <label for="Address">Address</label>
                    <input type="text" class="form-control" id="Address" placeholder="Street Nr." name="Address" >
                    <div class="valid-feedback">Looks good!</div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-4">
                      <label for="City">City</label>
                      <input type="text" class="form-control" id="City" placeholder="City" name="City" >
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                    <div class="form-group col-md-4">
                      <label for="State">State</label>
                      <input type="text" class="form-control" id="State" placeholder="State" name="State" >
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                    <div class="form-group col-md-4">
                      <label for="Zip">Zip</label>
                      <input type="text" class="form-control" id="Zip" name="Zip" >
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-2">
                      <label for="lat">Latitude</label>
                      <input type="text" class="form-control" id="lat" placeholder="Latitude" name="lat" >
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                    <div class="form-group col-md-2">
                      <label for="lon">Longitude</label>
                      <input type="text" class="form-control" id="lon" placeholder="Longitude" name="lon" >
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                </div>
            </div>

            <div class="container_border mt-3" id="SelectFromMap" style="">
                <div class="form-row">
                    <div class="form-group col-md-3">
                      <label for="lat_fm">Latitude</label>
                      <input type="text" value="" class="form-control" id="lat_fm" placeholder="Latitude" name="lat_fm" required>
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                    <div class="form-group col-md-3">
                      <label for="lon_fm">Longitude</label>
                      <input type="text" value="" class="form-control" id="lon_fm" placeholder="Longitude" name="lon_fm" required>
                      <div class="valid-feedback">Looks good!</div>
                    </div>
                </div>
                <div id="mapid" style="width: 600px; height: 400px;" class="my-3"></div>
            </div>


            <button type="submit" class="mt-3 btn btn-dark">
                Continue
            </button>
        </form>
    </div>
    <script type="text/javascript">
        function test(Names){
            if (Names=="AddManually"){
                dform=document.getElementById("AddManually")
                dform.style.display='';
                nform=document.getElementById("SelectFromMap")
                nform.style.display='none';
                document.getElementById("lat_fm").required=false;
                document.getElementById("lon_fm").required=false;
                document.getElementById("Address").required=true;
                document.getElementById("City").required=true;
                document.getElementById("State").required=true;
                document.getElementById("Zip").required=true;
                document.getElementById("lat").required=true;
                document.getElementById("lon").required=true;
            }else if (Names=="SelectFromMap"){
                dform=document.getElementById("SelectFromMap")
                dform.style.display='';
                nform=document.getElementById("AddManually")
                nform.style.display='none';
                document.getElementById("lat_fm").required=true;
                document.getElementById("lon_fm").required=true;
                document.getElementById("Address").required=false;
                document.getElementById("City").required=false;
                document.getElementById("State").required=false;
                document.getElementById("Zip").required=false;
                document.getElementById("lat").required=false;
                document.getElementById("lon").required=false;
            }

        }
    </script>
    <script>
        var mymap = L.map('mapid').setView([49.8922839,8.6396314], 9);
        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiY2ZzZ2VudCIsImEiOiJjbDFwN2N0bWQwcWxzM2JwZ3BncDdpM3JlIn0.6WZHljjw5-YB2ELfb_VW1Q', {
          attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
          maxZoom: 18,
          id: 'mapbox/streets-v11',
          tileSize: 512,
          zoomOffset: -1,
          accessToken: 'your.mapbox.access.token'
        }).addTo(mymap);



        function onMapClick(e) {
            lat_input = document.getElementById("lat_fm")
            lat_input.value = e.latlng.lat.toFixed(4)
            lon_input = document.getElementById("lon_fm")
            lon_input.value = e.latlng.lng.toFixed(4)
        }

        mymap.on('click', onMapClick);
    </script>

    <script>
        (function() {
          'use strict';
            //document.getElementById("AddManually").selected = true;
            //document.getElementById("SelectFromMap").selected = false;
            //document.getElementById("lat_fm").required=false;
            //document.getElementById("lon_fm").required=false;
            //document.getElementById("Address").required=true;
            //document.getElementById("City").required=true;
            //document.getElementById("State").required=true;
            //document.getElementById("Zip").required=true;
            //document.getElementById("lat").required=true;
            //document.getElementById("lon").required=true;
          window.addEventListener('load', function() {
            // Fetch all the forms we want to apply custom Bootstrap validation styles to
            var forms = document.getElementsByClassName('needs-validation');
            // Loop over them and prevent submission
            var validation = Array.prototype.filter.call(forms, function(form) {
              form.addEventListener('submit', function(event) {
                if (form.checkValidity() === false) {
                  event.preventDefault();
                  event.stopPropagation();
                }
                form.classList.add('was-validated');
              }, false);
            });
          }, false);
        })();
    </script>
</body>
</html>